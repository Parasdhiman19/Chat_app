<!DOCTYPE html>
<html>
  <head>
    <title>WebSocket Test</title>
  </head>
  <body>
    <input type="text" id="messageInput" placeholder="Type a message..." />
    <button onclick="sendMessage()">Send</button>
    <ul id="messages"></ul>

    <script>
      const socket = new WebSocket(
        "wss://" + window.location.host + "/chat_ws/"
      );

      socket.onmessage = function (e) {
        const data = JSON.parse(e.data);
        const messages = data.response;
        const msgList = document.getElementById("messages");
        console.log(msgList);
        msgList.innerHTML = "";

        messages.forEach((msg) => {
          const li = document.createElement("li");
          li.textContent = msg;
          msgList.appendChild(li);
        });
      };

      function sendMessage() {
        const input = document.getElementById("messageInput");
        socket.send(JSON.stringify({ message: input.value }));
        input.value = "";
      }
    </script>
  </body>
</html>
